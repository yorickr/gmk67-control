from enum import IntEnum

GMK67_VID = 0x05AC
GMK67_PID = 0x024F

ROWS = [
    [0, 5, 7, 12, 16, 20, 24, 29, 33, 37, 41, 46, 51, 55, None, None],
    [1, None, 8, 13, 17, 21, 25, 30, 34, 38, 42, 47, 52, 56, 58, 62],
    [2, None, 9, 14, 18, 22, 26, 31, 35, 39, 43, 48, 53, None, 59, 63],
    [3, None, 10, 15, 19, 23, 27, 32, 36, 40, 44, 49, 54, None, 60, 64],
    [4, 6, 11, None, None, None, 28, None, None, None, 45, 50, None, 57, 61, 65]
]
# Translates position from ROWS to the memory position.
POSITION_TO_MEMORY_LOCATION = {
    0: 1, 5: 20, 7: 21, 12: 22, 16: 23, 20: 24, 24: 25, 29: 26, 33: 27, 37: 28, 41: 29, 46: 30, 51: 31, 1: 37,
    8: 38, 13: 39, 17: 40, 21: 41, 25: 42, 30: 43, 34: 44, 38: 45, 42: 46, 47: 47, 52: 48, 56: 49, 2: 55, 9: 56,
    14: 57, 18: 58, 22: 59, 26: 60, 31: 61, 35: 62, 39: 63, 43: 64, 48: 65, 53: 66, 58: 67, 3: 73, 10: 74,
    15: 75, 19: 76, 23: 77, 27: 78, 32: 79, 36: 80, 40: 81, 44: 82, 49: 83, 54: 84, 59: 85, 4: 91, 6: 92,
    11: 93, 28: 94, 45: 95, 50: 96, 57: 99, 61: 100, 60: 101, 65: 102, 55: 103, 63: 118, 62: 119, 64: 121
}


class GMK67(IntEnum):
    MIN_SPEED = 0x00
    MAX_SPEED = 0x0F
    MIN_BRIGHTNESS = 0x00
    MAX_BRIGHTNESS = 0x0F
    WIDTH = 16
    HEIGHT = 5


class Constants(IntEnum):
    REPORT_ID = 0x00
    PACKET_DATA_LENGTH = 64
    COLOR_BUF_SIZE = 512
    EFFECT_PAGE_LENGTH = 16
    LED_SPECIAL_EFFECT_PACKETS = 0x01
    PACKET_HEADER = 0x04
    EFFECT_PAGE_CHECK_CODE_L = 0xAA
    EFFECT_PAGE_CHECK_CODE_H = 0x55


class Commands(IntEnum):
    COMMUNICATION_END_COMMAND = 0x02
    GET_BASIC_INFO_COMMAND = 0x05
    READ_KEY_DEFINITION_AREA_COMMAND = 0x10
    WRITE_KEY_DEFINITION_AREA_COMMAND = 0x11
    READ_LED_EFFECT_DEFINITION_AREA_COMMAND = 0x12
    WRITE_LED_SPECIAL_EFFECT_AREA_COMMAND = 0x13
    READ_MACRO_DEFINITION_AREA_COMMAND = 0x14
    WRITE_MACRO_DEFINITION_AREA_COMMAND = 0x15
    READ_GAME_MODE_AREA_COMMAND = 0x16
    WRITE_GAME_MODE_AREA_COMMAND = 0x17
    TURN_ON_CUSTOMIZATION_COMMAND = 0x18
    TURN_OFF_CUSTOMIZATION_COMMAND = 0x19
    LED_EFFECT_START_COMMAND = 0xF0
    LED_SYNC_INITIAL_COMMAND = 0xF1
    LED_SYNC_START_COMMAND = 0xF2
    LED_SYNC_STOP_COMMAND = 0xF3
    RANDOM_PACKET_START_COMMAND = 0xAB


class LightingModes(IntEnum):
    STATIC_MODE = 0x01
    KEYSTROKE_LIGHT_UP_MODE = 0x02
    KEYSTROKE_DIM_MODE = 0x03
    SPARKLE_MODE = 0x04
    RAIN_MODE = 0x05
    RANDOM_COLORS_MODE = 0x06
    BREATHING_MODE = 0x07
    SPECTRUM_CYCLE_MODE = 0x08
    RING_GRADIENT_MODE = 0x09
    VERTICAL_GRADIENT_MODE = 0x0A
    HORIZONTAL_GRADIENT_WAVE_MODE = 0x0B
    AROUND_EDGES_MODE = 0x0C
    KEYSTROKE_HORIZONTAL_LINES = 0x0D
    KEYSTROKE_TITLED_LINES_MODE = 0x0E
    KEYSTROKE_RIPPLES_MODE = 0x0F
    SEQUENCE_MODE = 0x10
    WAVE_LINE_MODE = 0x11
    TILTED_LINES_MODE = 0x12
    BACK_AND_FORTH_MODE = 0x13
    DIRECT_MODE = 0x20
    CUSTOM_MODE = 0x23
    LIGHTS_OFF_MODE = 0x80
